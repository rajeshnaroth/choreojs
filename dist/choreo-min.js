!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.Choreo=n():t.Choreo=n()}(this,function(){return function(t){function n(e){if(r[e])return r[e].exports;var o=r[e]={exports:{},id:e,loaded:!1};return t[e].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var r={};return n.m=t,n.c=r,n.p="",n(0)}([function(t,n,r){"use strict";function e(t){if(Array.isArray(t)){for(var n=0,r=Array(t.length);t.length>n;n++)r[n]=t[n];return r}return Array.from(t)}function o(t,n){return function(r){n--<=0&&n!==1/0||p.pipeP.apply(void 0,e(i(t).map(function(t){return t.promise})))(r||"")}}function i(t){return t.reduce(function(t,n){switch(n.type){case"delay":return u(t,function(t){return c(t,n.data)},function(t){return t});case"promise":return u.apply(void 0,[t,function(t){return a(t)}].concat(e(n.data)));case"function":return u.apply(void 0,[t,function(t){return c(t,1)}].concat(e(n.data)))}},[])}function u(t,n){for(var r=arguments.length,e=Array(r>2?r-2:0),o=2;r>o;o++)e[o-2]=arguments[o];return t.concat(e.reduce(function(t,r){return t.concat(Array.isArray(r)?r.map(function(t){return n(t)}):n(r))},[]))}function c(t,n){var r=0;if(NaN===+n||0>=n)throw Error("time:"+n+" must be a number greater than zero.");if("function"!=typeof t)throw Error("action is not a function");return{promise:function(e){return new Promise(function(o,i){r=setTimeout(function(){r=0,o(t.call(void 0,e))},+n)})},cancel:function(){r>0&&clearTimeout(r)}}}function a(t){var n=!1;if("function"!=typeof t)throw Error("action is not a function");return{promise:function(r){return new Promise(function(e,o){t(r).then(function(t){return n?o({isCanceled:!0}):e(t)}).catch(function(t){return o(n?{isCanceled:!0}:t)})})},cancel:function(){n=!0}}}Object.defineProperty(n,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=r(1),s={create:function(){function t(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];s=u.apply(void 0,[s,function(t){return c(t,1)}].concat(n)),y.push({type:"function",data:n})}function n(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];return console.log("_addPromise: ",n),s=u.apply(void 0,[s,function(t){return a(t)}].concat(n)),y.push({type:"promise",data:n}),this}function r(t){if(+t<=0)throw Error("time:"+t+" must be a number greater than zero.");return s=u(s,function(n){return c(n,t)},function(t){return t}),y.push({type:"delay",data:t}),this}var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=[],l=!1,d=0,y=[];if(!Array.isArray(i))throw Error("Choreo initialization is not an array");return i.forEach(function(e){"function"==typeof e?t(e):"object"===(void 0===e?"undefined":f(e))&&e.promise?n(e.promise):"object"===(void 0===e?"undefined":f(e))&&e.wait&&r(e.wait)}),Object.create({add:function(){return t.apply(void 0,arguments),this},addPromise:function(){return n.apply(void 0,arguments),this},wait:function(t){return r(t),this},popLast:function(){return s.pop(),this},cancel:function(){s.forEach(function(t){return t.cancel()})},start:function(t){return this.add(o(y,d)),l||(p.pipeP.apply(void 0,e(s.map(function(t){return t.promise})))(t||""),l=!0),this},loop:function(t){if(0>=t)throw Error("Repeat value must be > 0. Default value is 1");return d=t-1,this}})},cancellableTimeout:c,cancellablePromise:a};n.default=s},function(t,n){"use strict";function r(t,n){var r=this;return function(){for(var e=arguments.length,o=Array(e),i=0;e>i;i++)o[i]=arguments[i];return t.call.apply(t,[r].concat(o)).then(function(t){return n.call(r,t)})}}Object.defineProperty(n,"__esModule",{value:!0});n.pipeP=function(){for(var t=arguments.length,n=Array(t),e=0;t>e;e++)n[e]=arguments[e];if(1>n.length)throw Error("you must provide at least one promise to pipe");var o=n[0],i=n.slice(1,1/0);return i.reduce(r,o)}}])});